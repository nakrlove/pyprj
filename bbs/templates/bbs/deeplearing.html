<!DOCTYPE html>
<html>
<head>
    <title>Deep Learning Result</title>
</head>
<body>
   


    <h1>Deep Learning Result</h1>

    {% if result %}
        <ul>
        {% for key, value in result.items %}
            <li>{{ key }} : {{ value }}</li>
        {% endfor %}
        </ul>
    {% else %}
        <p>결과가 없습니다.</p>
    {% endif %}

    <!-- 예: POST 요청을 보내는 폼 -->
    <!-- <form method="post">
        {% csrf_token %}
        <button type="submit">실행</button>
    </form> -->
     <div id="map" style="width:1020px;height:800px;"></div>

</body>
<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=42332023945af1a3297997651bc50abf&libraries=services"></script>
<!-- <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=42332023945af1a3297997651bc50abf&libraries=services"></script> -->
<script>
var map = new kakao.maps.Map(document.getElementById('map'), {
    center: new kakao.maps.LatLng(37.5665, 126.9780),
    level: 7
});
var geocoder = new kakao.maps.services.Geocoder();

// GeoJSON 데이터 불러오기 (샘플: 종로구 일부 좌표만 예시)
// var geojsonUrl = "/static/bbs/HangJeongDong_ver20250101.geojson"; // 실제 행정동 경계 데이터 경로
var geojsonUrl = "/static/bbs/Seoul_all_gu_boundary.geojson"; 

var polygons = []; // 현재 표시된 폴리곤 저장

var addr = '서울특별시 강남구'

// 1) 주소 → 중심 좌표 얻기
geocoder.addressSearch(addr, function(result, status) {
    if (status === kakao.maps.services.Status.OK) {
        var coords = new kakao.maps.LatLng(result[0].y, result[0].x);
        map.setCenter(coords);

        // 2) GeoJSON 불러오기
        fetch(geojsonUrl)
            .then(res => res.json())
            .then(data => {
                // 기존 폴리곤 제거
                polygons.forEach(p => p.setMap(null));
                polygons = [];

                // 3) GeoJSON 데이터 중 검색한 주소에 해당하는 동 찾기
                data.features.forEach(function(feature) {
                   // var dongName = feature.properties.EMD_KOR_NM; // GeoJSON 속성값 (법정동명)
                    //var dongName = feature.properties.sidonm; // GeoJSON 속성값 (법정동명)
                    var dongName = feature.properties.sidonm + ' '+feature.properties.sggnm; // GeoJSON 속성값 (법정동명)
                    if (addr.includes(dongName)) {
                        var coordsArr = feature.geometry.coordinates[0].map(function(coord) {
                            return new kakao.maps.LatLng(coord[1], coord[0]);
                        });

                        // 4) 폴리곤 생성
                        var polygon = new kakao.maps.Polygon({
                            path: coordsArr,
                            strokeWeight: 2,
                            strokeColor: '#FF0000',
                            strokeOpacity: 0.8,
                            fillColor: '#FF6600',
                            fillOpacity: 0.3
                        });
                        polygon.setMap(map);
                        polygons.push(polygon);

                        // 지도 영역 재설정 (폴리곤 전체 보이도록)
                        var bounds = new kakao.maps.LatLngBounds();
                        coordsArr.forEach(c => bounds.extend(c));
                        map.setBounds(bounds);
                    }
                });
            });
    }
});

</script>
</html>